@model AJWManagementPortal.Models.TransAndBank

@{
    Layout = "~/Views/Shared/_LayoutAccount.cshtml";
    var clearedBalance = 0.00;
    var clearedBalanceYest = 0.00;
    var closingBalance = 0.00;
    var inClearedBalance = 0.00;
    var currentBalance = 0.00;
    var totalPaid = 0.00;
    var remainingRecieved = 0.00;
    var openingBalane = 0.00;
    var totalInvome = 0.00;
    var totalInvomeYest = 0.00;
    var todayInvome = 0.00;

}

<!DOCTYPE html>

<html>
<head>
    <style type="text/css">
        .tg {
            border-collapse: collapse;
            border-spacing: 0;
        }

            .tg td {
                border-color: black;
                border-style: solid;
                border-width: 1px;
                font-family: Arial, sans-serif;
                font-size: 14px;
                overflow: hidden;
                padding: 4px 20px;
                word-break: normal;
            }

            .tg th {
                border-color: black;
                border-style: solid;
                border-width: 1px;
                font-family: Arial, sans-serif;
                font-size: 14px;
                font-weight: normal;
                overflow: hidden;
                padding: 4px 20px;
                word-break: normal;
            }

            .tg .tg-lboi {
                border-color: inherit;
                text-align: left;
                vertical-align: middle
            }

            .tg .tg-c6of {
                background-color: #ffffff;
                border-color: inherit;
                text-align: left;
                vertical-align: top
            }

            .tg .tg-g7sd {
                border-color: inherit;
                font-weight: bold;
                text-align: left;
                vertical-align: middle
            }

            .tg .tg-0lax {
                text-align: left;
                vertical-align: top
            }

            .tg .tg-fymr {
                border-color: inherit;
                font-weight: bold;
                text-align: left;
                vertical-align: top
            }

            .tg .tg-0pky {
                border-color: inherit;
                text-align: left;
                vertical-align: top
            }
        /*  ------------------------------------------------*/
        #customers, tblcustomers {
            font-family: Arial, Helvetica, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }

        td > input {
            width: 100%;
        }

        #customers td, #customers th {
            border: 1px solid #ddd;
            padding: 8px;
        }

        #customers tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        #customers tr:hover {
            background-color: #ddd;
        }

        #customers th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #4CAF50;
            color: white;
        }

        td {
            overflow: hidden;
        }

        /* ---------------------------Main table*/


        /*      ---------------signature*/

        .tg {
            border-collapse: collapse;
            border-spacing: 0;
        }

            .tg td {
                border-color: black;
                border-style: solid;
                border-width: 1px;
                font-family: Arial, sans-serif;
                font-size: 14px;
                overflow: hidden;
                padding: 5px 20px;
                word-break: normal;
            }

            .tg th {
                border-color: black;
                border-style: solid;
                border-width: 1px;
                font-family: Arial, sans-serif;
                font-size: 14px;
                font-weight: normal;
                overflow: hidden;
                padding: 5px 20px;
                word-break: normal;
            }

            .tg .tg-ulps {
                background-color: #34cdf9;
                border-color: inherit;
                color: #ffffff;
                font-size: 36px;
                text-align: center;
                vertical-align: top
            }

            .tg .tg-0lax {
                text-align: left;
                vertical-align: top
            }

        .tabled {
            position: center;
            align-content: center;
            text-align: center;
        }

        .signt {
            position: center;
            align-content: center;
            text-align: center;
        }

        .btnlink {
            /* position: center;*/
            /*   align-content: center;*/
            /* text-align: center;*/
            margin-left: -190px;
        }

        table {
            table-layout: fixed;
            width: 100%;
        }

        input[type="text"] {
            width: 100%;
            box-sizing: border-box;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
        }
    </style>

    <script>
        $(document).ready(function () {
            $('#tblcustomers').DataTable();
        });
    </script>
    <title>Index</title>
</head>
<body>


    @{
        DateTime yesterday = Model.date.AddDays(-1);
        DateTime dayBeforeYesterday = yesterday.Date.AddDays(-1);
        DateTime today = DateTime.Today;
        if (Model.date != null)
        {
            today = Model.date;
        }
    }
    @*btn link*@
    @*btn sheet list*@
    @*daily Table*@

    <!-- Code by w3codegenerator.com -->
    <form class="tabled">
        <table class="table table-bordered" id="tblcustomers">
            <thead>
                <tr class="text-center">

                    <th colspan="18" scope="col" class="bg-dark text-white"><img src="~/Image/white.png" alt="Image" width="100" height="100" /><br />اے جے ڈبلیو ایگرو انڈسٹری</th>

                </tr>
                <tr>
                    <th class="text-center bg-dark text-white" colspan="18" scope="col">ڈیلی کیش جاری رپورٹ اکاؤنٹ آفس</th>
                </tr>
                <tr>

                    <th class="text-left" colspan="18" scope="col"> <input type="datetime-local" id="birthdaytime" name="birthdaytime">  : تاریخ </th>
                </tr>
                <tr style="position:center;align-content:center;text-align:center">

                    <th class="text-center bg-dark text-white" scope="col">CRUD آپریشن</th>
                    <th class="text-center bg-dark text-white" scope="col"></th>
                    <th class="text-center bg-dark text-white" scope="col">اکاؤنٹنٹ</th>
                    <th class="text-center bg-dark text-white" scope="col">پرچيز ر</th>
                    <th class="text-center bg-dark text-white" scope="col">سرپلس</th>
                    <th class="text-center bg-dark text-white" scope="col">پرچيز آرڈر_P<br>گیٹ پاسس_G<br>چیک نمبر_C<br>سروس آرڈر_S</th>
                    <th class="text-center bg-dark text-white" scope="col">آن لائن_O<br>ڈپازٹ سلپ_D  <br>چیک نمبر_C</th>
                    <th class="text-center bg-dark text-white" scope="col">آمدن</th>
                    <th class="text-center bg-dark text-white" scope="col">بقایا رقم واصو ل</th>
                    <th class="text-center bg-dark text-white" scope="col">انکلیریڈ رقم</th>
                    <th class="text-center bg-dark text-white" scope="col">کلیریڈ رقم</th>
                    <th class="text-center bg-dark text-white" scope="col">رقم ادا</th>
                    <th class="text-center bg-dark text-white" scope="col">تاریخ</th>
                    <th class="text-center bg-dark text-white" scope="col" colspan="3">تفصیل</th>
                    <th class="text-center bg-dark text-white" scope="col">اکاؤنٹ اقسام</th>
                    <th class="text-center bg-dark text-white" scope="col">نمبر شمار</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.aDailyCashes)
                {
                    inClearedBalance += item.lnClearedAmount;
                    {
                        if (item.ValueDate == today || (item.ValueDate < today && item.lnClearedAmount != 0))
                        {
                            clearedBalance += item.clearedAmount;
                            totalPaid += item.paidAmount;
                            remainingRecieved += item.remainingGained;
                            todayInvome += item.income;



                            <tr>

                                @if (!Model.hide)
                                {
                                    <td>
                                        <a asp-action="Edit" asp-route-id="@item.Id">Edit</a> |
                                        <a asp-action="Details" asp-route-id="@item.Id">Details</a> |
                                        <a asp-action="Delete" asp-route-id="@item.Id">Delete</a>
                                    </td>

                                    <td><input type="button" value="Remove" onclick="Remove(this)" /></td>
                                }
                                else
                                {
                                    <td></td>
                                    <td></td>
                                }
                                <td>@Html.DisplayFor(modelItem => item.accountant)</td>
                                <td>@Html.DisplayFor(modelItem => item.purchaser)</td>
                                <td>@Html.DisplayFor(modelItem => item.surplus)</td>
                                <td>@Html.DisplayFor(modelItem => item.pOrder)</td>
                                <td>@Html.DisplayFor(modelItem => item.online)</td>
                                <td>@Html.DisplayFor(modelItem => item.income)</td>
                                <td>@Html.DisplayFor(modelItem => item.remainingGained)</td>
                                <td>@Html.DisplayFor(modelItem => item.lnClearedAmount)</td>
                                <td>@Html.DisplayFor(modelItem => item.clearedAmount)</td>
                                <td>@Html.DisplayFor(modelItem => item.paidAmount)</td>
                                <td>@Html.DisplayFor(modelItem => item.ValueDate)</td>
                                <td colspan="3"><textarea type="text" >@Html.DisplayFor(modelItem => item.Description)</textarea></td>
                                <td>@Html.DisplayFor(modelItem => item.Name)</td>
                                <td>@Html.DisplayFor(modelItem => item.Id)</td>




                            </tr>
                        }
                        if (DateTime.Compare(today, item.ValueDate) != 0)
                        {
                            totalInvomeYest += item.income;
                            clearedBalanceYest += item.clearedAmount;
                        }

                    }
                }


                @{
                    openingBalane += totalInvomeYest - clearedBalanceYest;
                    openingBalane = Math.Abs(openingBalane);
                    totalInvome += openingBalane + todayInvome;

                    closingBalance += totalInvome - clearedBalance;

                    currentBalance += closingBalance - inClearedBalance;
                }
            </tbody>
            <tfoot>
                @if (!Model.hide)
                {
                    <tr>
                        <th colspan="1"></th>
                        <th colspan="1"></th>
                        <th colspan="1"><input type="text" id="accountant" /></th>

                        <th><input type="text" id="purchaser" /></th>
                        <th><input type="text" id="surplus" /></th>
                        <th colspan="1"><input type="text" id="pOrder" /></th>
                        <th colspan="1"><input type="text" id="online" /></th>

                        <th colspan="1"><input type="text" id="income" /></th>
                        <th colspan="1"><input type="text" id="remainingGained" /></th>
                        <th colspan="1"><input type="text" id="lnClearedAmount" /></th>
                        <th colspan="1"><input type="text" id="clearedAmount" /></th>
                        <th colspan="1"><input type="text" id="paidAmount" /></th>
                        <th colspan="1"><input type="text" id="txtDate" /></th>
                        <th colspan="3"><textarea type="text" id="txtDesc"></textarea></th>
                        <th colspan="1">
                            <select id="txtName" style="width: 100%; box-sizing: border-box;">

                                <option>Internal</option>
                                <option>Petty</option>
                            </select>

                        </th>
                        <th colspan="1"><input type="button" id="btnAdd" value="Add" /></th>
                    </tr>
                }
                <tr>
                    @if (!Model.hide)
                    {
                        <td class="text-center bg-dark text-white" colspan="18">   <input type="button" id="btnSave" value="Save All" /></td>
                    }
                </tr>
                <tr id="total">
                    <th colspan="2">ٹوٹل </th>
                    <th id=""></th>
                    <th id=""></th>
                    <th id="t10"></th>
                    <th id="t11"></th>
                    <th id="t12"></th>
                    <th id="t9"></th>
                    <th id="t8"></th>
                    <th id="t7"></th>
                    <th id="t6"></th>
                    <th id="t5"></th>
                    <th id=""></th>
                    <th id=""></th>
                    <th id=""></th>
                    <th id=""></th>
                    <th id=""></th>
                    <th id=""></th>

            </tfoot>
        </table>
    </form>
    @*extra table*@

    <table class="tg" id="customers">
        <thead>
            <tr>
                <th colspan="8"></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="tg-lboi" rowspan="2">@totalPaid</td>
                <td class="tg-g7sd" rowspan="2"> ٹوٹل رقم ادا</td>
                <td class="tg-0lax" colspan="2" rowspan="2"></td>
                <td class="tg-lboi" rowspan="2">@totalInvome</td>
                <td class="tg-g7sd" rowspan="2">
                    ٹوٹل بیلنس
                </td>
                <td class="tg-fymr">  آج کی آمدن</td>
                <td class="tg-fymr">    اوپننگ بیلنس</td>
            </tr>
            <tr>
                <td class="tg-0pky">@todayInvome</td>
                <td class="tg-0pky">@openingBalane</td>
            </tr>
            <tr>
                <td class="tg-c6of" colspan="8"></td>
            </tr>
            <tr>
                <td class="tg-0pky">@clearedBalance</td>
                <td class="tg-fymr"> کلیرڈ بیلنس/آج کا خرچ</td>
                <td class="tg-0lax" colspan="2" rowspan="2"></td>
                <td class="tg-0pky" colspan="2">@clearedBalance</td>
                <td class="tg-0pky" colspan="2"><span style="font-weight:bold">کلیرڈ بیلنس/آج کا خرچ </span></td>
            </tr>
            <tr>
                <td class="tg-0pky">
                    @{
                        var value1 = totalPaid - clearedBalance;
                        @value1
                    }
                </td>
                <td class="tg-fymr">باقی بیلنس</td>
                <td class="tg-0pky" colspan="2">@closingBalance</td>
                <td class="tg-0pky" colspan="2"><span style="font-weight:bold">کلوزنگ بیلنس </span></td>
            </tr>
            <tr>
                <td class="tg-c6of" colspan="8"></td>
            </tr>
            <tr>
                <td class="tg-0pky">@inClearedBalance</td>
                <td class="tg-fymr"> انکلیرد بیلنس</td>
                <td class="tg-0lax" colspan="2" rowspan="2"></td>
                <td class="tg-0pky" colspan="2">@inClearedBalance</td>
                <td class="tg-0pky" colspan="2"><span style="font-weight:bold">انکلیرد بیلنس</span></td>
            </tr>
            <tr>
                <td class="tg-0pky"> @remainingRecieved</td>
                <td class="tg-fymr">بقایاوصو ل</td>
                <td class="tg-0pky" colspan="2">@currentBalance</td>
                <td class="tg-0pky" colspan="2"> موجودہ بیلنس</td>
            </tr>
        </tbody>
    </table>
    @*extra table*@


    @*signature*@

    @*signature*@
    <form class="signt">
        @*sign*@
        <table class="table table-bordered table-dark">
            <thead>
                <tr>
                    <th colspan="4" class="text-center" scope="col">دستخط</th>

                </tr>
            </thead>
            <tbody>
                <tr class="text-center">
                    <th scope="row">Account Manager</th>
                    <th>C.E.O</th>
                    <th>G.M</th>
                    <th>D.G.M</th>
                </tr>
                <tr class="text-center align-content-center">
                    <td>
                        <input type="file" id="myFile" name="filename"><br />
                        <img src="~/Image/sign.png" class="img-rounded" alt="Cinque Terre" width="304" height="136">
                    </td>
                    <td class="tg-0lax">
                        <input type="file" id="myFile" name="filename"><br />
                        <img src="~/Image/sign.png" class="img-rounded" alt="Cinque Terre" width="304" height="136">
                    </td>
                    <td class="tg-0lax">
                        <input type="file" id="myFile" name="filename"><br />
                        <img src="~/Image/sign.png" class="img-rounded" alt="Cinque Terre" width="304" height="136">
                    </td>
                    <td class="tg-0lax">
                        <input type="file" id="myFile" name="filename"><br />
                        <img src="~/Image/sign.png" class="img-rounded" alt="Cinque Terre" width="304" height="136">
                    </td>
                </tr>
                <tr>
                    <td colspan="4">                  
                        <button type="button" asp-action="" asp-area="" asp-controller="" class="btn btn-primary btn-lg"><i class="fas fa-file-download"></i>Download</button>
                        <a type="button" asp-action="Sheets" asp-area="Account" asp-controller="Account" class="btn btn-success btn-lg"><i class="fas fa-save"></i>Save</a>
                        <button type="button" asp-action="" asp-area="" asp-controller="" class="btn btn-danger btn-lg"><i class="fas fa-pen-alt"></i>Clear</button>
                        <button type="button" asp-action="" asp-area="" asp-controller="" class="btn btn-primary btn-lg"><i class="fas fa-print"></i>Print</button>
                </td>
                </tr>
            </tbody>
        </table>
    </form>
    @*sign*@

    @section Scripts{
        <script>
            $("body").ready(function () {

                debugger;
                var paidAmount = 0, clearedAmount = 0, lnClearedAmount = 0, remainingGained = 0, surplus = 0, income = 0;
                var pOnline = 0, pOrder = 0;
                $("#tblcustomers TBODY TR").each(function () {
                    var row = $(this);


                    paidAmount += parseInt(row.find("TD").eq(11).text());
                    clearedAmount += parseInt(row.find("TD").eq(10).text());
                    lnClearedAmount += parseInt(row.find("TD").eq(9).text());
                    remainingGained += parseInt(row.find("TD").eq(8).text());
                    surplus += parseInt(row.find("TD").eq(4).text());
                    pOnline += parseInt(row.find("TD").eq(6).text());
                    pOrder += parseInt(row.find("TD").eq(5).text());
                    income += parseInt(row.find("TD").eq(7).text());

                });
                $("#total #t5").append(paidAmount);
                $("#total #t6").append(clearedAmount);
                $("#total #t7").append(lnClearedAmount);
                $("#total #t8").append(remainingGained);
                $("#total #t9").append(income);
                $("#total #t10").append(surplus);
                $("#total #t12").append(pOnline);
                $("#total #t11").append(pOrder);
            });
            $("body").on("click", "#btnAdd", function () {




                //Reference the Name and Country TextBoxes.
                var txtName = $("#txtName");
                var txtDesc = $("#txtDesc");
                var txtDate = $("#txtDate");
                var clearedAmount = $("#clearedAmount");
                var paidAmount = $("#paidAmount");
                var lnClearedAmount = $("#lnClearedAmount");
                var remainingGained = $("#remainingGained");
                var surplus = $("#surplus");
                var purchaser = $("#purchaser");
                var income = $("#income");
                var pOrder = $("#pOrder");
                var pOnline = $("#online");
                var accountant = $("#accountant")
                //Get the reference of the Table's TBODY element.
                var tBody = $("#tblcustomers > TBODY")[0];

                //Add Row.
                var row = tBody.insertRow(-1);

                var cell = $(row.insertCell(-1));
                //Add Button cell.
                cell = $(row.insertCell(-1));
                var btnRemove = $("<input />");
                btnRemove.attr("type", "button");
                btnRemove.attr("onclick", "Remove(this);");
                btnRemove.val("Remove");
                cell.append(btnRemove);

                cell = $(row.insertCell(-1));
                cell.html(accountant.val());

                cell = $(row.insertCell(-1));
                cell.html(purchaser.val());


                //Add Country cell.
                cell = $(row.insertCell(-1));
                cell.html(surplus.val());

                cell = $(row.insertCell(-1));
                cell.html(pOrder.val());

                cell = $(row.insertCell(-1));
                cell.html(pOnline.val());

                //Add Country cell.
                cell = $(row.insertCell(-1));
                cell.html(income.val());

                //Add Country cell.
                cell = $(row.insertCell(-1));
                cell.html(remainingGained.val());


                //Add Country cell.
                cell = $(row.insertCell(-1));
                cell.html(lnClearedAmount.val());


                //Add Country cell.
                cell = $(row.insertCell(-1));
                cell.html(clearedAmount.val());


                //Add Country cell.
                cell = $(row.insertCell(-1));
                cell.html(paidAmount.val());

                //Add Country cell.
                cell = $(row.insertCell(-1));
                cell.html(txtDate.val());


                //Add Country cell.
                cell = $(row.insertCell(-1));
                cell.html(txtDesc.val());


                //Add Name cell.
                cell = $(row.insertCell(-1));
                cell.html(txtName.val());



                //Clear the TextBoxes.
                txtName.val("");
                txtDesc.val("");
                txtDate.val("");
                pOnline.val("");
                pOrder.val("");
                accountant.val("");
                clearedAmount.val("");
                paidAmount.val("");
                lnClearedAmount.val("");
                remainingGained.val("");
                surplus.val("");
                purchaser.val("");
                income.val("");
            });

            function Remove(button) {
                //Determine the reference of the Row using the Button.
                var row = $(button).closest("TR");
                var name = $("TD", row).eq(0).html();
                if (confirm("Do you want to delete: " + name)) {
                    //Get the reference of the Table.
                    var table = $("#tblcustomers")[0];

                    //Delete the Table row using it's Index.
                    table.deleteRow(row[0].rowIndex);
                }
            };

            $("body").on("click", "#btnSave", function () {
                //Loop through the Table rows and build a JSON array.
                var dateV= '@Model.date.ToString("dd-MM-yyyy")';
                var aDailyCashes = new Array();
                $("#tblcustomers TBODY TR").each(function () {
                    var row = $(this);
                    var aDailyCash = {};
                    aDailyCash.Name = row.find("TD").eq(14).text();
                    aDailyCash.Description = row.find("TD").eq(13).text();
                    aDailyCash.ValueDate = row.find("TD").eq(12).text();
                    aDailyCash.paidAmount = row.find("TD").eq(11).text();
                    aDailyCash.clearedAmount = row.find("TD").eq(10).text();
                    aDailyCash.lnClearedAmount = row.find("TD").eq(9).text();
                    aDailyCash.remainingGained = row.find("TD").eq(8).text();
                    aDailyCash.surplus = row.find("TD").eq(4).text();
                    aDailyCash.purchaser = row.find("TD").eq(3).text();
                    aDailyCash.income = row.find("TD").eq(7).text();
                    aDailyCash.accountant = row.find("TD").eq(6).text();
                    aDailyCash.online = row.find("TD").eq(5).text();
                    aDailyCash.pOrder = row.find("TD").eq(4).text();

                    aDailyCashes.push(aDailyCash);
                });

                //Send the JSON array to Controller using AJAX.
                $.ajax({
                    type: "POST",
                    url: "../../../Sheets/aDailyCashes/InsertCustomers",
                    data: { data: aDailyCashes, id: dateV },
                    success: function (r) {
                        alert(r + " record(s) inserted.");
                        window.location.replace("../../../Sheets/aDailyCashes/");
                    }
                });
            });

            $("body").on("click", "#btnSavee", function () {
                //Send the JSON array to Controller using AJAX.

                var data = "hamza";

                $.ajax({
                    type: "POST",
                    url: "/aDailyCashes/insert",
                    data: { data: "test" },
                    success: function (r) {
                        alert(r + " record(s) inserted.");
                    }
                });
            });


        </script>
    }
</body>
</html>